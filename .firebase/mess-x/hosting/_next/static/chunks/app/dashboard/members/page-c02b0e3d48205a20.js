(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6253],{7390:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},13896:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},15121:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]])},15599:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},17313:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>c,av:()=>o,j7:()=>d,tU:()=>l});var a=t(95155),n=t(12115),r=t(60704),i=t(59434);let l=r.bL,d=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.B8,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...n})});d.displayName=r.B8.displayName;let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.l9,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...n})});c.displayName=r.l9.displayName;let o=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.UC,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...n})});o.displayName=r.UC.displayName},31550:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},44838:(e,s,t)=>{"use strict";t.d(s,{SQ:()=>u,_2:()=>h,lp:()=>x,mB:()=>p,rI:()=>o,ty:()=>m});var a=t(95155),n=t(12115),r=t(48698),i=t(73158),l=t(10518),d=t(70154),c=t(59434);let o=r.bL,m=r.l9;r.YJ,r.ZL,r.Pb,r.z6,n.forwardRef((e,s)=>{let{className:t,inset:n,children:l,...d}=e;return(0,a.jsxs)(r.ZP,{ref:s,className:(0,c.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...d,children:[l,(0,a.jsx)(i.A,{className:"ml-auto"})]})}).displayName=r.ZP.displayName,n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.G5,{ref:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}).displayName=r.G5.displayName;let u=n.forwardRef((e,s)=>{let{className:t,sideOffset:n=4,...i}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsx)(r.UC,{ref:s,sideOffset:n,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})})});u.displayName=r.UC.displayName;let h=n.forwardRef((e,s)=>{let{className:t,inset:n,...i}=e;return(0,a.jsx)(r.q7,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...i})});h.displayName=r.q7.displayName,n.forwardRef((e,s)=>{let{className:t,children:n,checked:i,...d}=e;return(0,a.jsxs)(r.H_,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:i,...d,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})}),n]})}).displayName=r.H_.displayName,n.forwardRef((e,s)=>{let{className:t,children:n,...i}=e;return(0,a.jsxs)(r.hN,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(d.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=r.hN.displayName;let x=n.forwardRef((e,s)=>{let{className:t,inset:n,...i}=e;return(0,a.jsx)(r.JU,{ref:s,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...i})});x.displayName=r.JU.displayName;let p=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...n})});p.displayName=r.wv.displayName},59114:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]])},60704:(e,s,t)=>{"use strict";t.d(s,{B8:()=>I,UC:()=>q,bL:()=>R,l9:()=>M});var a=t(12115),n=t(85185),r=t(46081),i=t(89196),l=t(28905),d=t(63655),c=t(94315),o=t(5845),m=t(61285),u=t(95155),h="Tabs",[x,p]=(0,r.A)(h,[i.RG]),f=(0,i.RG)(),[j,v]=x(h),y=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:a,onValueChange:n,defaultValue:r,orientation:i="horizontal",dir:l,activationMode:x="automatic",...p}=e,f=(0,c.jH)(l),[v,y]=(0,o.i)({prop:a,onChange:n,defaultProp:null!=r?r:"",caller:h});return(0,u.jsx)(j,{scope:t,baseId:(0,m.B)(),value:v,onValueChange:y,orientation:i,dir:f,activationMode:x,children:(0,u.jsx)(d.sG.div,{dir:f,"data-orientation":i,...p,ref:s})})});y.displayName=h;var g="TabsList",N=a.forwardRef((e,s)=>{let{__scopeTabs:t,loop:a=!0,...n}=e,r=v(g,t),l=f(t);return(0,u.jsx)(i.bL,{asChild:!0,...l,orientation:r.orientation,dir:r.dir,loop:a,children:(0,u.jsx)(d.sG.div,{role:"tablist","aria-orientation":r.orientation,...n,ref:s})})});N.displayName=g;var b="TabsTrigger",w=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:a,disabled:r=!1,...l}=e,c=v(b,t),o=f(t),m=A(c.baseId,a),h=S(c.baseId,a),x=a===c.value;return(0,u.jsx)(i.q7,{asChild:!0,...o,focusable:!r,active:x,children:(0,u.jsx)(d.sG.button,{type:"button",role:"tab","aria-selected":x,"aria-controls":h,"data-state":x?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:m,...l,ref:s,onMouseDown:(0,n.m)(e.onMouseDown,e=>{r||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(a)}),onKeyDown:(0,n.m)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(a)}),onFocus:(0,n.m)(e.onFocus,()=>{let e="manual"!==c.activationMode;x||r||!e||c.onValueChange(a)})})})});w.displayName=b;var C="TabsContent",k=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:n,forceMount:r,children:i,...c}=e,o=v(C,t),m=A(o.baseId,n),h=S(o.baseId,n),x=n===o.value,p=a.useRef(x);return a.useEffect(()=>{let e=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,u.jsx)(l.C,{present:r||x,children:t=>{let{present:a}=t;return(0,u.jsx)(d.sG.div,{"data-state":x?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":m,hidden:!a,id:h,tabIndex:0,...c,ref:s,style:{...e.style,animationDuration:p.current?"0s":void 0},children:a&&i})}})});function A(e,s){return"".concat(e,"-trigger-").concat(s)}function S(e,s){return"".concat(e,"-content-").concat(s)}k.displayName=C;var R=y,I=N,M=w,q=k},62801:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>D});var a=t(95155),n=t(12115),r=t(30285),i=t(50172),l=t(13896),d=t(91394),c=t(66695),o=t(85127),m=t(40157);let u=(0,m.A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var h=t(31550),x=t(59114),p=t(15121);let f=(0,m.A)("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var j=t(44838),v=t(98905),y=t(90010),g=t(87481);let N=n.memo(function(e){let{members:s,messId:t,currentUserProfile:i,onUpdate:l,onAction:m}=e,N="manager"===i.role,{toast:b}=(0,g.dj)(),[w,C]=(0,n.useState)(!1),k=async e=>{C(!0);try{await (0,v.xb)(t,e.id),b({title:"Success!",description:"".concat(e.name," has been removed from the mess.")}),l()}catch(e){b({title:"Error",description:e.message||"Failed to remove member.",variant:"destructive"})}finally{C(!1)}};return(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{className:"font-headline",children:"Member List"}),(0,a.jsx)(c.BT,{children:"Here are all the members currently in your mess."})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"Member"}),(0,a.jsx)(o.nd,{className:"text-right",children:"Balance"}),(0,a.jsx)(o.nd,{className:"text-center",children:"Total Meals"}),(0,a.jsx)(o.nd,{className:"text-right",children:(0,a.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,a.jsx)(o.BF,{children:s.map(e=>(0,a.jsxs)(o.Hj,{className:"hover:bg-muted/50",children:[(0,a.jsx)(o.nA,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(d.eu,{className:"h-10 w-10",children:[(0,a.jsx)(d.BK,{src:e.avatar,alt:e.name,"data-ai-hint":"person portrait"}),(0,a.jsx)(d.q5,{children:e.name.substring(0,2).toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:e.name}),"manager"===e.role&&(0,a.jsx)("span",{className:"text-xs text-primary ml-2 font-normal",children:"(Manager)"})]})]})}),(0,a.jsxs)(o.nA,{className:"text-right font-mono font-bold text-lg ".concat(e.balance>=0?"text-success":"text-destructive"),children:["৳",e.balance.toFixed(2)]}),(0,a.jsx)(o.nA,{className:"text-center font-mono text-lg",children:e.meals.toFixed(1).replace(/\.0$/,"")}),(0,a.jsx)(o.nA,{className:"text-right",children:(0,a.jsxs)(j.rI,{children:[(0,a.jsx)(j.ty,{asChild:!0,children:(0,a.jsxs)(r.$,{"aria-haspopup":"true",size:"icon",variant:"ghost",children:[(0,a.jsx)(u,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"sr-only",children:["Toggle menu for ",e.name]})]})}),(0,a.jsxs)(j.SQ,{align:"end",children:[(0,a.jsx)(j.lp,{children:"Actions"}),(0,a.jsxs)(j._2,{onSelect:()=>m("ledger",e),children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"View Meal Ledger"]}),(0,a.jsxs)(j._2,{onSelect:()=>m("transactions",e),children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"View Transactions"]}),N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.mB,{}),(0,a.jsxs)(j._2,{onSelect:()=>m("mealRecord",e),children:[(0,a.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Add/Edit Meal Record"]}),e.id!==i.uid&&(0,a.jsxs)(y.Lt,{children:[(0,a.jsx)(y.tv,{asChild:!0,children:(0,a.jsxs)(j._2,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:bg-destructive/10 focus:text-destructive",children:[(0,a.jsx)(f,{className:"mr-2 h-4 w-4"}),"Remove from Mess"]})}),(0,a.jsxs)(y.EO,{children:[(0,a.jsxs)(y.wd,{children:[(0,a.jsxs)(y.r7,{children:["Remove ",e.name,"?"]}),(0,a.jsxs)(y.$v,{children:["Are you sure you want to remove ",(0,a.jsx)("strong",{children:e.name})," from the mess? This action cannot be undone."]})]}),(0,a.jsxs)(y.ck,{children:[(0,a.jsx)(y.Zr,{children:"Cancel"}),(0,a.jsx)(y.Rx,{onClick:()=>k(e),disabled:w,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Confirm Removal"})]})]})]})]})]})]})})]},e.id))})]})})]})});var b=t(93004),w=t(56104),C=t(35695),k=t(54165),A=t(62523),S=t(85057),R=t(15599),I=t(7390);function M(e){let{isOpen:s,setIsOpen:t,messName:n,inviteCode:i}=e,{toast:l}=(0,g.dj)(),d=()=>{navigator.clipboard.writeText(i),l({title:"Copied!",description:"Invite code copied to clipboard."})},c=async()=>{let e={title:"Join ".concat(n," on Mess Ledger"),text:'Join our mess "'.concat(n,'" on Mess Ledger with this code: ').concat(i),url:window.location.origin};if(navigator.share)try{await navigator.share(e)}catch(e){console.error("Error sharing:",e),d(),l({title:"Sharing failed",description:"Invite code copied to clipboard instead.",variant:"destructive"})}else d(),l({title:"Share not supported",description:"Invite code copied to clipboard instead."})};return(0,a.jsx)(k.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(k.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsx)(k.L3,{className:"font-headline",children:"Invite New Members"}),(0,a.jsxs)(k.rr,{children:['Share this invite code with people you want to join your mess, "',n,'".']})]}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)(S.J,{htmlFor:"invite-code",className:"text-muted-foreground",children:"Invite Code"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(A.p,{id:"invite-code",value:i,readOnly:!0,className:"uppercase text-lg font-mono tracking-widest"}),(0,a.jsxs)(r.$,{type:"button",size:"icon",variant:"outline",onClick:d,children:[(0,a.jsx)(R.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Copy"})]}),(0,a.jsxs)(r.$,{type:"button",size:"icon",variant:"outline",onClick:c,children:[(0,a.jsx)(I.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Share"})]})]})]})]})})}var q=t(63894),E=t(17313),F=t(66424),O=t(75943),L=t(77223),T=t(83013),V=t(77128),z=t(65842);function _(e){let{isOpen:s,setIsOpen:t,member:l,messId:d,currentUserProfile:c,onSuccess:m}=e,[u,h]=(0,n.useState)([]),[x,p]=(0,n.useState)([]),[f,j]=(0,n.useState)(!0),[N,b]=(0,n.useState)(!1),[w,C]=(0,n.useState)(!1),[A,S]=(0,n.useState)(!1),[R,I]=(0,n.useState)(null),[M,q]=(0,n.useState)(null),[_,P]=(0,n.useState)(null),{toast:H}=(0,g.dj)(),D="manager"===c.role,U=c.uid===l.id,B=(0,n.useCallback)(()=>{s&&l&&(j(!0),Promise.all([(0,v.Ce)(d,l.id),(0,v.Q8)(d,l.id)]).then(e=>{let[s,t]=e;h(s),p(t)}).catch(e=>{console.error("Failed to fetch transaction history:",e),H({title:"Error",description:"Could not load transaction history.",variant:"destructive"})}).finally(()=>j(!1)))},[s,d,l,H]);(0,n.useEffect)(()=>{B()},[B]);let G=e=>{I(e),C(!0)},$=e=>{q(e),S(!0)},Z=e=>{P(e)},J=async()=>{if(_){b(!0);try{D?"deposit"===_.type?(await (0,v.Wc)(d,_.data),H({title:"Success",description:"Deposit has been deleted."})):"expense"===_.type&&(await (0,v.Wz)(d,_.data.id),H({title:"Success",description:"Expense has been deleted."})):U&&("deposit"===_.type?(await (0,v.jA)(d,_.data),H({title:"Request Sent",description:"Your request to delete the deposit has been sent for approval."})):"expense"===_.type&&(await (0,v.b1)(d,_.data),H({title:"Request Sent",description:"Your request to delete the expense has been sent for approval."}))),m(),B()}catch(e){console.error("Failed to process delete request:",e),H({title:"Error",description:"Could not process the delete request.",variant:"destructive"})}finally{b(!1),P(null)}}},Y=e=>{let{data:s,type:t}=e;return(0,a.jsx)(F.F,{className:"h-72",children:(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:["expense"===t&&(0,a.jsx)(o.nd,{children:"Description"}),(0,a.jsx)(o.nd,{children:"Date"}),(0,a.jsx)(o.nd,{className:"text-right",children:"Amount"}),(D||U)&&(0,a.jsx)(o.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(o.BF,{children:s.length>0?s.map(e=>(0,a.jsxs)(o.Hj,{children:["expense"===t&&(0,a.jsx)(o.nA,{children:e.description}),(0,a.jsx)(o.nA,{children:(0,T.GP)(new Date(e.date),"PP")}),(0,a.jsxs)(o.nA,{className:"text-right font-mono ".concat("deposit"===t?"text-success":"text-destructive"),children:["deposit"===t?"+":"-"," ৳",e.amount.toFixed(2)]}),(D||U)&&(0,a.jsxs)(o.nA,{className:"text-right",children:[(0,a.jsx)(r.$,{variant:"ghost",size:"icon",onClick:()=>"deposit"===t?G(e):$(e),children:(0,a.jsx)(O.A,{className:"h-4 w-4"})}),(0,a.jsx)(r.$,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>Z({type:t,data:e}),children:(0,a.jsx)(L.A,{className:"h-4 w-4"})})]})]},e.id)):(0,a.jsx)(o.Hj,{children:(0,a.jsxs)(o.nA,{colSpan:D||U?4:3,className:"h-24 text-center",children:["No ",t,"s found."]})})})]})})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(k.Cf,{className:"max-w-3xl",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsxs)(k.L3,{className:"font-headline",children:["Transaction History for ",l.name]}),(0,a.jsx)(k.rr,{children:D?"View and manage approved deposits and expenses for this member.":U?"View your approved transactions. You can request changes to your own records.":"View approved transactions for this member."})]}),f?(0,a.jsx)("div",{className:"flex h-80 items-center justify-center",children:(0,a.jsx)(i.A,{className:"h-8 w-8 animate-spin"})}):(0,a.jsxs)(E.tU,{defaultValue:"deposits",className:"py-4",children:[(0,a.jsxs)(E.j7,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(E.Xi,{value:"deposits",children:["Deposits (",u.length,")"]}),(0,a.jsxs)(E.Xi,{value:"expenses",children:["Expenses (",x.length,")"]})]}),(0,a.jsx)(E.av,{value:"deposits",className:"mt-4",children:(0,a.jsx)(Y,{data:u,type:"deposit"})}),(0,a.jsx)(E.av,{value:"expenses",className:"mt-4",children:(0,a.jsx)(Y,{data:x,type:"expense"})})]})]})}),R&&(0,a.jsx)(V.b,{isOpen:w,setIsOpen:C,deposit:R,messId:d,onSuccess:()=>{B(),m()},isMemberRequest:!D&&U}),M&&(0,a.jsx)(z.N,{isOpen:A,setIsOpen:S,expense:M,messId:d,onSuccess:()=>{B(),m()},isMemberRequest:!D&&U}),(0,a.jsx)(y.Lt,{open:!!_,onOpenChange:e=>!e&&P(null),children:(0,a.jsxs)(y.EO,{children:[(0,a.jsxs)(y.wd,{children:[(0,a.jsx)(y.r7,{children:"Are you absolutely sure?"}),(0,a.jsx)(y.$v,{children:D?"This action cannot be undone. This will permanently delete the ".concat(null==_?void 0:_.type," of ৳").concat(null==_?void 0:_.data.amount.toFixed(2)," and adjust the member's balance."):"This will send a request to the manager to delete this ".concat(null==_?void 0:_.type,". You will be notified when it's approved or rejected.")})]}),(0,a.jsxs)(y.ck,{children:[(0,a.jsx)(y.Zr,{children:"Cancel"}),(0,a.jsxs)(y.Rx,{onClick:J,disabled:N,className:"bg-destructive hover:bg-destructive/90",children:[N?(0,a.jsx)(i.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,D?"Confirm Delete":"Send Request"]})]})]})})]})}var P=t(83343);function H(e){let{isOpen:s,setIsOpen:t,messId:r,memberId:l,memberName:d}=e,[c,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{s&&r&&l&&(h(!0),(0,v.nE)(r,l,30).then(m).catch(console.error).finally(()=>h(!1)))},[s,r,l]),(0,a.jsx)(k.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(k.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsxs)(k.L3,{className:"font-headline",children:["Meal Ledger for ",d]}),(0,a.jsx)(k.rr,{children:"Showing meal history for the last 30 days."})]}),(0,a.jsx)("div",{className:"py-4",children:u?(0,a.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,a.jsx)(i.A,{className:"h-8 w-8 animate-spin"})}):(0,a.jsx)(F.F,{className:"h-96",children:(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{className:"sticky top-0 bg-card",children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"Date"}),(0,a.jsx)(o.nd,{className:"text-center",children:"Breakfast"}),(0,a.jsx)(o.nd,{className:"text-center",children:"Lunch"}),(0,a.jsx)(o.nd,{className:"text-center",children:"Dinner"})]})}),(0,a.jsx)(o.BF,{children:c.length>0?c.map(e=>(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nA,{className:"font-medium",children:(0,T.GP)((0,P.H)(e.date),"EEE, MMM d")}),(0,a.jsx)(o.nA,{className:"text-center font-mono",children:e.breakfast}),(0,a.jsx)(o.nA,{className:"text-center font-mono",children:e.lunch}),(0,a.jsx)(o.nA,{className:"text-center font-mono",children:e.dinner})]},e.date)):(0,a.jsx)(o.Hj,{children:(0,a.jsx)(o.nA,{colSpan:4,className:"text-center text-muted-foreground h-24",children:"No meal records found."})})})]})})})]})})}function D(){var e;let[s,t]=(0,n.useState)([]),[d,c]=(0,n.useState)(null),[o,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),x=(0,C.useRouter)(),[p,f]=(0,n.useState)(null),[j,y]=(0,n.useState)(!1),[g,k]=(0,n.useState)(!1),[A,S]=(0,n.useState)(!1),[R,I]=(0,n.useState)(!1),[E,F]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!w.j2)return void x.push("/login");let e=(0,b.hg)(w.j2,e=>{e?f(e):x.push("/login")});return()=>e()},[x]);let O=(0,n.useCallback)(()=>{p&&(h(!0),(0,v.VM)(p.uid).then(e=>{c(e),e&&e.messId?Promise.all([(0,v.pR)(e.messId),(0,v.ZJ)(e.messId)]).then(e=>{let[s,a]=e;t(s),m(a)}).catch(e=>{console.error("Failed to load members page data",e)}).finally(()=>{h(!1)}):x.push("/welcome")}))},[p,x]);(0,n.useEffect)(()=>{O()},[O]);let L=(0,n.useCallback)((e,s)=>{F(s),"mealRecord"===e&&k(!0),"transactions"===e&&S(!0),"ledger"===e&&I(!0)},[]);if(u||!d)return(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsx)(i.A,{className:"h-8 w-8 animate-spin"})});let T=(null==d?void 0:d.role)==="manager";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-end",children:T&&(0,a.jsxs)(r.$,{onClick:()=>y(!0),children:[(0,a.jsx)(l.A,{className:"mr-2 h-4 w-4"})," Invite New Member"]})}),(null==d?void 0:d.messId)&&(0,a.jsx)(N,{members:s,messId:d.messId,currentUserProfile:d,onUpdate:O,onAction:L})]}),o&&o.inviteCode&&(0,a.jsx)(M,{isOpen:j,setIsOpen:y,messName:o.name,inviteCode:o.inviteCode}),E&&(null==d?void 0:d.messId)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(q.c,{isOpen:g,setIsOpen:k,messId:d.messId,memberId:E.id,memberName:E.name,onSuccess:O,mealSettings:null!=(e=null==o?void 0:o.mealSettings)?e:null}),(0,a.jsx)(_,{isOpen:A,setIsOpen:S,member:E,messId:d.messId,currentUserProfile:d,onSuccess:O}),(0,a.jsx)(H,{isOpen:R,setIsOpen:I,messId:d.messId,memberId:E.id,memberName:E.name})]})]})}},65842:(e,s,t)=>{"use strict";t.d(s,{N:()=>h});var a=t(95155),n=t(12115),r=t(30285),i=t(54165),l=t(62523),d=t(85057),c=t(88539),o=t(50172),m=t(87481),u=t(98905);function h(e){let{isOpen:s,setIsOpen:t,expense:h,messId:x,onSuccess:p,isMemberRequest:f=!1}=e,[j,v]=(0,n.useState)(h.amount.toString()),[y,g]=(0,n.useState)(h.description),[N,b]=(0,n.useState)(!1),{toast:w}=(0,m.dj)(),C=async()=>{let e=parseFloat(j);if(!y.trim()||!j||isNaN(e)||e<=0)return void w({title:"Invalid Input",description:"Please enter a valid description and positive amount.",variant:"destructive"});if(e===h.amount&&y.trim()===h.description)return void t(!1);b(!0);try{f?(await (0,u.YG)(x,h,e,y.trim()),w({title:"Request Sent!",description:"Your edit request has been sent to the manager for approval."})):(await (0,u.eY)(x,h.id,e,y.trim()),w({title:"Success!",description:"The expense has been updated."})),p(),t(!1)}catch(e){console.error("Failed to update expense:",e),w({title:"Error",description:"Could not process the request. Please try again.",variant:"destructive"})}finally{b(!1)}};return(0,a.jsx)(i.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(i.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(i.c7,{children:[(0,a.jsx)(i.L3,{className:"font-headline",children:f?"Request Expense Edit":"Edit Expense"}),(0,a.jsx)(i.rr,{children:f?"Propose new details for this expense. This will be sent to the manager for approval.":"Update the expense details submitted by ".concat(h.addedBy,".")})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(d.J,{htmlFor:"description",className:"text-right",children:"Description"}),(0,a.jsx)(c.T,{id:"description",value:y,onChange:e=>g(e.target.value),className:"col-span-3",placeholder:"e.g., Weekly groceries"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(d.J,{htmlFor:"amount",className:"text-right",children:"Amount (৳)"}),(0,a.jsx)(l.p,{id:"amount",type:"number",value:j,onChange:e=>v(e.target.value),className:"col-span-3",placeholder:"e.g., 1250.50"})]})]}),(0,a.jsxs)(i.Es,{children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsxs)(r.$,{type:"submit",onClick:C,disabled:N,children:[N&&(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4 animate-spin"}),f?"Send Request":"Save Changes"]})]})]})})}},66424:(e,s,t)=>{"use strict";t.d(s,{F:()=>l});var a=t(95155),n=t(12115),r=t(47655),i=t(59434);let l=n.forwardRef((e,s)=>{let{className:t,children:n,...l}=e;return(0,a.jsxs)(r.bL,{ref:s,className:(0,i.cn)("relative overflow-hidden",t),...l,children:[(0,a.jsx)(r.LM,{className:"h-full w-full rounded-[inherit]",children:n}),(0,a.jsx)(d,{}),(0,a.jsx)(r.OK,{})]})});l.displayName=r.bL.displayName;let d=n.forwardRef((e,s)=>{let{className:t,orientation:n="vertical",...l}=e;return(0,a.jsx)(r.VM,{ref:s,orientation:n,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...l,children:(0,a.jsx)(r.lr,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=r.VM.displayName},77128:(e,s,t)=>{"use strict";t.d(s,{b:()=>u});var a=t(95155),n=t(12115),r=t(30285),i=t(54165),l=t(62523),d=t(85057),c=t(50172),o=t(87481),m=t(98905);function u(e){let{isOpen:s,setIsOpen:t,deposit:u,messId:h,onSuccess:x,isMemberRequest:p=!1}=e,[f,j]=(0,n.useState)(u.amount.toString()),[v,y]=(0,n.useState)(!1),{toast:g}=(0,o.dj)(),N=async()=>{let e=parseFloat(f);if(!f||isNaN(e)||e<=0)return void g({title:"Invalid Amount",description:"Please enter a valid positive number for the deposit amount.",variant:"destructive"});if(e===u.amount)return void t(!1);y(!0);try{p?(await (0,m.Oq)(h,u,e),g({title:"Request Sent!",description:"Your edit request has been sent to the manager for approval."})):(await (0,m.kQ)(h,u,e),g({title:"Success!",description:"The deposit has been updated."})),x(),t(!1)}catch(e){console.error("Failed to process deposit edit:",e),g({title:"Error",description:"Could not process the request. Please try again.",variant:"destructive"})}finally{y(!1)}};return(0,a.jsx)(i.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(i.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(i.c7,{children:[(0,a.jsx)(i.L3,{className:"font-headline",children:p?"Request Deposit Edit":"Edit Deposit"}),(0,a.jsx)(i.rr,{children:p?"Propose a new amount for this deposit. This will be sent to the manager for approval.":"Update the deposit amount for ".concat(u.memberName,". The member's balance will be adjusted automatically.")})]}),(0,a.jsx)("div",{className:"grid gap-4 py-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(d.J,{htmlFor:"amount",className:"text-right",children:"Amount (৳)"}),(0,a.jsx)(l.p,{id:"amount",type:"number",value:f,onChange:e=>j(e.target.value),className:"col-span-3",placeholder:"e.g., 2000"})]})}),(0,a.jsxs)(i.Es,{children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsxs)(r.$,{type:"submit",onClick:N,disabled:v,children:[v&&(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}),p?"Send Request":"Save Changes"]})]})]})})}},81379:(e,s,t)=>{Promise.resolve().then(t.bind(t,62801))},88539:(e,s,t)=>{"use strict";t.d(s,{T:()=>i});var a=t(95155),n=t(12115),r=t(59434);let i=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...n})});i.displayName="Textarea"},91394:(e,s,t)=>{"use strict";t.d(s,{BK:()=>d,eu:()=>l,q5:()=>c});var a=t(95155),n=t(12115),r=t(54011),i=t(59434);let l=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.bL,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...n})});l.displayName=r.bL.displayName;let d=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r._V,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",t),...n})});d.displayName=r._V.displayName;let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.H4,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...n})});c.displayName=r.H4.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,1982,8502,7239,9032,7328,5876,5152,3013,7655,5576,4257,3024,1785,5951,4987,8441,1684,7358],()=>s(81379)),_N_E=e.O()}]);