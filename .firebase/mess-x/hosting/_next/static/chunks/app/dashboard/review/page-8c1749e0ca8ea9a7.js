(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1190],{17313:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>c,av:()=>o,j7:()=>l,tU:()=>d});var i=t(95155),a=t(12115),n=t(60704),r=t(59434);let d=n.bL,l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(n.B8,{ref:s,className:(0,r.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})});l.displayName=n.B8.displayName;let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(n.l9,{ref:s,className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})});c.displayName=n.l9.displayName;let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(n.UC,{ref:s,className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})});o.displayName=n.UC.displayName},26126:(e,s,t)=>{"use strict";t.d(s,{E:()=>d});var i=t(95155);t(12115);var a=t(74466),n=t(59434);let r=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:s,variant:t,...a}=e;return(0,i.jsx)("div",{className:(0,n.cn)(r({variant:t}),s),...a})}},48082:(e,s,t)=>{Promise.resolve().then(t.bind(t,65064))},65064:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var i=t(95155),a=t(12115),n=t(30285),r=t(66695),d=t(17313),l=t(50172),c=t(19968),o=t(25318),u=t(10518),x=t(87481),m=t(93004),p=t(56104),h=t(35695),f=t(98905),v=t(83013),j=t(26126);function g(){let[e,s]=(0,a.useState)(null),[t,g]=(0,a.useState)(null),[N,b]=(0,a.useState)([]),[y,w]=(0,a.useState)([]),[A,S]=(0,a.useState)(!0),[T,E]=(0,a.useState)({}),{toast:I}=(0,x.dj)(),R=(0,h.useRouter)();(0,a.useEffect)(()=>{let e=(0,m.hg)(p.j2,e=>{e?s(e):R.push("/login")});return()=>e()},[R]),(0,a.useEffect)(()=>{e&&(0,f.VM)(e.uid).then(e=>{g(e),(null==e?void 0:e.messId)&&"manager"===e.role?Promise.all([(0,f.lB)(e.messId),(0,f.tW)(e.messId)]).then(e=>{let[s,t]=e;b(s),w(t),S(!1)}):e?(I({title:"Unauthorized",description:"You don't have permission to view this page.",variant:"destructive"}),R.push("/dashboard")):S(!1)})},[e,R,I]);let _=async(e,s,i)=>{if(null==t?void 0:t.messId){E(s=>({...s,[e.id]:!0}));try{"expense"===i?"approve"===s?(await (0,f.Sh)(t.messId,e),b(s=>s.filter(s=>s.id!==e.id))):(await (0,f.cW)(t.messId,e.id),b(s=>s.filter(s=>s.id!==e.id))):"approve"===s?(await (0,f.Gc)(t.messId,e),w(s=>s.filter(s=>s.id!==e.id))):(await (0,f.A1)(t.messId,e.id),w(s=>s.filter(s=>s.id!==e.id))),I({title:"Success",description:"The request has been ".concat(s,"d.")})}catch(e){console.error("Failed to ".concat(s," ").concat(i),e),I({title:"Error",description:"Could not process the request. Please try again.",variant:"destructive"})}finally{E(s=>({...s,[e.id]:!1}))}}};return A?(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,i.jsx)(l.A,{className:"h-8 w-8 animate-spin"})}):(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsxs)(d.tU,{defaultValue:"expenses",className:"w-full",children:[(0,i.jsxs)(d.j7,{className:"grid w-full grid-cols-2",children:[(0,i.jsxs)(d.Xi,{value:"expenses",children:["Expenses (",N.length,")"]}),(0,i.jsxs)(d.Xi,{value:"deposits",children:["Deposits (",y.length,")"]})]}),(0,i.jsx)(d.av,{value:"expenses",children:(0,i.jsxs)(r.Zp,{children:[(0,i.jsxs)(r.aR,{children:[(0,i.jsx)(r.ZB,{className:"font-headline",children:"Pending Expense Requests"}),(0,i.jsx)(r.BT,{children:"Review new submissions, edits, and deletions for expenses."})]}),(0,i.jsx)(r.Wu,{className:"space-y-4",children:N.length>0?N.map(e=>{var s,t;let a=e.type||"new";return(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 rounded-lg border p-4",children:[(0,i.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(j.E,{variant:"delete"===a?"destructive":"secondary",children:a.toUpperCase()}),(0,i.jsx)("p",{className:"font-medium text-muted-foreground",children:"Expense Request"})]}),"new"===a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{className:"font-bold text-xl",children:["৳",e.amount.toFixed(2)]}),(0,i.jsx)("p",{className:"font-medium",children:e.description})]}),"edit"===a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 font-bold text-lg",children:[(0,i.jsxs)("span",{className:"text-muted-foreground line-through",children:["৳",null==(s=e.originalData)?void 0:s.amount.toFixed(2)]}),(0,i.jsx)(c.A,{className:"h-4 w-4"}),(0,i.jsxs)("span",{children:["৳",e.amount.toFixed(2)]})]}),(0,i.jsxs)("div",{className:"flex items-start gap-2 text-sm",children:[(0,i.jsx)("span",{className:"text-muted-foreground line-through",children:null==(t=e.originalData)?void 0:t.description}),(0,i.jsx)(c.A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,i.jsx)("span",{className:"font-medium",children:e.description})]})]}),"delete"===a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{className:"font-bold text-xl text-destructive line-through",children:["৳",e.amount.toFixed(2)]}),(0,i.jsx)("p",{className:"font-medium text-destructive line-through",children:e.description})]}),(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Submitted by ",e.addedBy," on ",(0,v.GP)(new Date(e.date),"PPP")]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)(n.$,{variant:"outline",size:"icon",className:"border-destructive text-destructive hover:bg-destructive/10 hover:text-destructive",onClick:()=>_(e,"reject","expense"),disabled:T[e.id],children:[T[e.id]?(0,i.jsx)(l.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(o.A,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Reject"})]}),(0,i.jsxs)(n.$,{variant:"outline",size:"icon",className:"border-success text-success hover:bg-success/10 hover:text-success",onClick:()=>_(e,"approve","expense"),disabled:T[e.id],children:[T[e.id]?(0,i.jsx)(l.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(u.A,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Approve"})]})]})]},e.id)}):(0,i.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No pending expenses to review."})})]})}),(0,i.jsx)(d.av,{value:"deposits",children:(0,i.jsxs)(r.Zp,{children:[(0,i.jsxs)(r.aR,{children:[(0,i.jsx)(r.ZB,{className:"font-headline",children:"Pending Deposit Requests"}),(0,i.jsx)(r.BT,{children:"Review new submissions, edits, and deletions for deposits."})]}),(0,i.jsx)(r.Wu,{className:"space-y-4",children:y.length>0?y.map(e=>{var s;let t=e.type||"new";return(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 rounded-lg border p-4",children:[(0,i.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(j.E,{variant:"delete"===t?"destructive":"secondary",children:t.toUpperCase()}),(0,i.jsx)("p",{className:"font-medium text-muted-foreground",children:"Deposit Request"})]}),"new"===t&&(0,i.jsxs)("p",{className:"font-bold text-xl",children:["৳",e.amount.toFixed(2)]}),"edit"===t&&(0,i.jsxs)("div",{className:"flex items-center gap-2 font-bold text-xl",children:[(0,i.jsxs)("span",{className:"text-muted-foreground line-through",children:["৳",null==(s=e.originalAmount)?void 0:s.toFixed(2)]}),(0,i.jsx)(c.A,{className:"h-4 w-4"}),(0,i.jsxs)("span",{children:["৳",e.amount.toFixed(2)]})]}),"delete"===t&&(0,i.jsxs)("p",{className:"font-bold text-xl text-destructive line-through",children:["৳",e.amount.toFixed(2)]}),(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Submitted by ",e.memberName," on ",(0,v.GP)(new Date(e.date),"PPP")]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)(n.$,{variant:"outline",size:"icon",className:"border-destructive text-destructive hover:bg-destructive/10 hover:text-destructive",onClick:()=>_(e,"reject","deposit"),disabled:T[e.id],children:[T[e.id]?(0,i.jsx)(l.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(o.A,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Reject"})]}),(0,i.jsxs)(n.$,{variant:"outline",size:"icon",className:"border-success text-success hover:bg-success/10 hover:text-success",onClick:()=>_(e,"approve","deposit"),disabled:T[e.id],children:[T[e.id]?(0,i.jsx)(l.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(u.A,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Approve"})]})]})]},e.id)}):(0,i.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No pending deposits to review."})})]})})]})})}},87481:(e,s,t)=>{"use strict";t.d(s,{dj:()=>x});var i=t(12115);let a=0,n=new Map,r=e=>{if(n.has(e))return;let s=setTimeout(()=>{n.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,s)},d=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?r(t):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},l=[],c={toasts:[]};function o(e){c=d(c,e),l.forEach(e=>{e(c)})}function u(e){let{...s}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),i=()=>o({type:"DISMISS_TOAST",toastId:t});return o({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||i()}}}),{id:t,dismiss:i,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function x(){let[e,s]=i.useState(c);return i.useEffect(()=>(l.push(s),()=>{let e=l.indexOf(s);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,1982,8502,7328,5876,3013,116,5951,8441,1684,7358],()=>s(48082)),_N_E=e.O()}]);