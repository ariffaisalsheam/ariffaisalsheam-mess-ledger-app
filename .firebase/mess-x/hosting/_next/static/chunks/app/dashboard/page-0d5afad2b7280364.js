(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{14636:(e,s,l)=>{"use strict";l.d(s,{AM:()=>n,Wv:()=>r,hl:()=>c});var t=l(95155),a=l(12115),d=l(20547),i=l(59434);let n=d.bL,r=d.l9,c=a.forwardRef((e,s)=>{let{className:l,align:a="center",sideOffset:n=4,...r}=e;return(0,t.jsx)(d.ZL,{children:(0,t.jsx)(d.UC,{ref:s,align:a,sideOffset:n,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),...r})})});c.displayName=d.UC.displayName},21436:(e,s,l)=>{Promise.resolve().then(l.bind(l,44879))},22346:(e,s,l)=>{"use strict";l.d(s,{w:()=>n});var t=l(95155),a=l(12115),d=l(87489),i=l(59434);let n=a.forwardRef((e,s)=>{let{className:l,orientation:a="horizontal",decorative:n=!0,...r}=e;return(0,t.jsx)(d.b,{ref:s,decorative:n,orientation:a,className:(0,i.cn)("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",l),...r})});n.displayName=d.b.displayName},24944:(e,s,l)=>{"use strict";l.d(s,{k:()=>n});var t=l(95155),a=l(12115),d=l(55863),i=l(59434);let n=a.forwardRef((e,s)=>{let{className:l,value:a,...n}=e;return(0,t.jsx)(d.bL,{ref:s,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...n,children:(0,t.jsx)(d.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});n.displayName=d.bL.displayName},44879:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>A});var t=l(95155),a=l(12115),d=l(30285),i=l(66695),n=l(66424),r=l(22346),c=l(24944),o=l(14636),x=l(50172),m=l(18046),h=l(13896),u=l(19591),f=l(59114),j=l(38988),p=l(19689),N=l(56104),v=l(93004),g=l(35695),b=l(98905),y=l(83013);let w=a.lazy(()=>l.e(5443).then(l.bind(l,15443)).then(e=>({default:e.AddDepositDialog}))),S=a.lazy(()=>Promise.all([l.e(3752),l.e(7295)]).then(l.bind(l,7295)).then(e=>({default:e.AddExpenseDialog}))),k=a.lazy(()=>Promise.all([l.e(4257),l.e(8834)]).then(l.bind(l,88834)).then(e=>({default:e.LogGuestMealDialog})));function A(){let[e,s]=(0,a.useState)(!0),[l,A]=(0,a.useState)(null),[I,M]=(0,a.useState)(null),[F,R]=(0,a.useState)(null),[O,P]=(0,a.useState)(null),[C,L]=(0,a.useState)([]),[z,D]=(0,a.useState)([]),[E,Z]=(0,a.useState)(!1),[B,T]=(0,a.useState)(!1),[_,W]=(0,a.useState)(!1),[$,G]=(0,a.useState)(!1),V=(0,g.useRouter)(),U=(0,a.useCallback)(async(e,s)=>{try{let[l,t,a,d]=await Promise.all([(0,b.Zc)(e,s),(0,b.ZJ)(e),(0,b.ck)(e,10),(0,b.Oe)(e,10)]);R(l),P(t),L(a),D(d)}catch(e){console.error("Failed to fetch dashboard data:",e)}},[]);(0,a.useEffect)(()=>{let e=(0,v.hg)(N.j2,e=>{e?A(e):V.push("/login")});return()=>e()},[V]),(0,a.useEffect)(()=>{l&&(s(!0),(0,b.VM)(l.uid).then(e=>{M(e),(null==e?void 0:e.messId)?U(e.messId,l.uid).finally(()=>s(!1)):e?V.push("/welcome"):s(!1)}))},[l,V,U]);let J=()=>{l&&(null==I?void 0:I.messId)&&(U(I.messId,l.uid),G(!1))};if(e)return(0,t.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,t.jsx)(x.A,{className:"h-8 w-8 animate-spin"})});let K=null==O?void 0:O.summary,X=e=>e&&!isNaN(e)?e:0,q=X(null==K?void 0:K.totalExpenses),H=X(null==K?void 0:K.totalDeposits),Q=X(null==K?void 0:K.totalMeals),Y=X(null==K?void 0:K.mealRate),ee=H-q,es=H>0?ee/H*100:0;return(0,t.jsxs)(t.Fragment,{children:[l&&(null==I?void 0:I.messId)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.Suspense,{fallback:(0,t.jsx)("div",{}),children:[E&&(0,t.jsx)(w,{isOpen:E,setIsOpen:Z,messId:I.messId,userId:l.uid,onSuccess:J}),B&&(0,t.jsx)(S,{isOpen:B,setIsOpen:T,messId:I.messId,userId:l.uid,onSuccess:J}),_&&(0,t.jsx)(k,{isOpen:_,setIsOpen:W,messId:I.messId,userId:l.uid,onSuccess:J,mealSettings:(null==O?void 0:O.mealSettings)||null})]}),(0,t.jsxs)(o.AM,{open:$,onOpenChange:G,children:[(0,t.jsx)(o.Wv,{asChild:!0,children:(0,t.jsxs)(d.$,{className:"fixed bottom-6 right-6 h-14 w-14 rounded-full shadow-lg z-20",children:[(0,t.jsx)(m.A,{className:"h-6 w-6"}),(0,t.jsx)("span",{className:"sr-only",children:"Add Transaction"})]})}),(0,t.jsx)(o.hl,{className:"w-56 p-2 mb-2",align:"end",side:"top",children:(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)(d.$,{variant:"ghost",className:"justify-start",onClick:()=>{W(!0),G(!1)},children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Log Guest Meal"]}),(0,t.jsxs)(d.$,{variant:"ghost",className:"justify-start",onClick:()=>{Z(!0),G(!1)},children:[(0,t.jsx)(u.A,{className:"mr-2 h-4 w-4"})," Add My Deposit"]}),(0,t.jsxs)(d.$,{variant:"ghost",className:"justify-start",onClick:()=>{T(!0),G(!1)},children:[(0,t.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Add Mess Expense"]})]})})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)(i.Zp,{className:"w-full",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsx)(i.ZB,{className:"font-headline",children:"Mess Financial Summary"}),(0,t.jsx)(i.BT,{children:"An overview of your mess's current financial status."})]}),(0,t.jsxs)(i.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Remaining Balance"}),(0,t.jsxs)("p",{className:"text-4xl font-bold ".concat(ee>=0?"text-success":"text-destructive"),children:["৳",ee.toFixed(2)]})]}),(0,t.jsx)(c.k,{value:es,"aria-label":"".concat(es.toFixed(0),"% of funds remaining")}),(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-x-4 gap-y-6 pt-2",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(j.A,{className:"h-5 w-5 text-primary mt-1 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Meal Rate"}),(0,t.jsxs)("p",{className:"text-lg font-bold",children:["৳",Y.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(p.A,{className:"h-5 w-5 text-primary mt-1 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Meals"}),(0,t.jsx)("p",{className:"text-lg font-bold",children:Q.toFixed(1).replace(/\.0$/,"")})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"h-5 w-5 mt-1 flex-shrink-0 rounded-full bg-destructive/20 flex items-center justify-center",children:(0,t.jsx)("p",{className:"font-bold text-destructive text-sm",children:"-"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Expenses"}),(0,t.jsxs)("p",{className:"text-lg font-bold",children:["৳",q.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"h-5 w-5 mt-1 flex-shrink-0 rounded-full bg-success/20 flex items-center justify-center",children:(0,t.jsx)("p",{className:"font-bold text-success text-sm",children:"+"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Deposits"}),(0,t.jsxs)("p",{className:"text-lg font-bold",children:["৳",H.toFixed(2)]})]})]})]})]})]}),(0,t.jsx)("h2",{className:"text-2xl font-headline font-semibold flex-1",children:"Recent Activity"}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)(i.Zp,{className:"flex flex-col",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsx)(i.ZB,{className:"font-headline",children:"Mess Expenses"}),(0,t.jsx)(i.BT,{children:"Last 10 approved expenses."})]}),(0,t.jsx)(i.Wu,{className:"flex-grow",children:(0,t.jsx)(n.F,{className:"h-72",children:C.length>0?(0,t.jsx)("div",{className:"space-y-4",children:C.map((e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.description}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Added by ",e.addedBy]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-bold text-lg text-destructive",children:["- ৳",e.amount.toFixed(2)]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,y.GP)(new Date(e.date),"PPP")})]})]}),s<C.length-1&&(0,t.jsx)(r.w,{className:"my-3"})]},e.id))}):(0,t.jsx)("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No expenses recorded yet."})})})]}),(0,t.jsxs)(i.Zp,{className:"flex flex-col",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsx)(i.ZB,{className:"font-headline",children:"Member Deposits"}),(0,t.jsx)(i.BT,{children:"Last 10 approved deposits."})]}),(0,t.jsx)(i.Wu,{className:"flex-grow",children:(0,t.jsx)(n.F,{className:"h-72",children:z.length>0?(0,t.jsx)("div",{className:"space-y-4",children:z.map((e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("div",{children:(0,t.jsx)("p",{className:"font-medium",children:e.memberName})}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-bold text-lg text-success",children:["+ ৳",e.amount.toFixed(2)]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,y.GP)(new Date(e.date),"PPP")})]})]}),s<z.length-1&&(0,t.jsx)(r.w,{className:"my-3"})]},e.id))}):(0,t.jsx)("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No deposits recorded yet."})})})]})]})]})]})}},66424:(e,s,l)=>{"use strict";l.d(s,{F:()=>n});var t=l(95155),a=l(12115),d=l(47655),i=l(59434);let n=a.forwardRef((e,s)=>{let{className:l,children:a,...n}=e;return(0,t.jsxs)(d.bL,{ref:s,className:(0,i.cn)("relative overflow-hidden",l),...n,children:[(0,t.jsx)(d.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,t.jsx)(r,{}),(0,t.jsx)(d.OK,{})]})});n.displayName=d.bL.displayName;let r=a.forwardRef((e,s)=>{let{className:l,orientation:a="vertical",...n}=e;return(0,t.jsx)(d.VM,{ref:s,orientation:a,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",l),...n,children:(0,t.jsx)(d.lr,{className:"relative flex-1 rounded-full bg-border"})})});r.displayName=d.VM.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,1982,8502,7239,9032,5876,5152,3013,7655,4361,5951,8441,1684,7358],()=>s(21436)),_N_E=e.O()}]);