(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6253],{7390:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},13896:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},15121:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]])},15599:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},31550:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},44838:(e,s,t)=>{"use strict";t.d(s,{SQ:()=>h,_2:()=>x,lp:()=>u,mB:()=>p,rI:()=>o,ty:()=>m});var a=t(95155),n=t(12115),r=t(48698),l=t(73158),i=t(10518),c=t(70154),d=t(59434);let o=r.bL,m=r.l9;r.YJ,r.ZL,r.Pb,r.z6,n.forwardRef((e,s)=>{let{className:t,inset:n,children:i,...c}=e;return(0,a.jsxs)(r.ZP,{ref:s,className:(0,d.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...c,children:[i,(0,a.jsx)(l.A,{className:"ml-auto"})]})}).displayName=r.ZP.displayName,n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.G5,{ref:s,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}).displayName=r.G5.displayName;let h=n.forwardRef((e,s)=>{let{className:t,sideOffset:n=4,...l}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsx)(r.UC,{ref:s,sideOffset:n,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})})});h.displayName=r.UC.displayName;let x=n.forwardRef((e,s)=>{let{className:t,inset:n,...l}=e;return(0,a.jsx)(r.q7,{ref:s,className:(0,d.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...l})});x.displayName=r.q7.displayName,n.forwardRef((e,s)=>{let{className:t,children:n,checked:l,...c}=e;return(0,a.jsxs)(r.H_,{ref:s,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:l,...c,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),n]})}).displayName=r.H_.displayName,n.forwardRef((e,s)=>{let{className:t,children:n,...l}=e;return(0,a.jsxs)(r.hN,{ref:s,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(c.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=r.hN.displayName;let u=n.forwardRef((e,s)=>{let{className:t,inset:n,...l}=e;return(0,a.jsx)(r.JU,{ref:s,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...l})});u.displayName=r.JU.displayName;let p=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.wv,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",t),...n})});p.displayName=r.wv.displayName},59114:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(40157).A)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]])},62801:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>U});var a=t(95155),n=t(12115),r=t(30285),l=t(50172),i=t(13896),c=t(91394),d=t(66695),o=t(85127),m=t(40157);let h=(0,m.A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var x=t(31550),u=t(59114),p=t(15121);let j=(0,m.A)("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var f=t(44838),y=t(98905),v=t(90010),N=t(87481);let g=n.memo(function(e){let{members:s,messId:t,currentUserProfile:l,onUpdate:i,onAction:m}=e,g="manager"===l.role,{toast:b}=(0,N.dj)(),[w,A]=(0,n.useState)(!1),k=async e=>{A(!0);try{await (0,y.xb)(t,e.id),b({title:"Success!",description:"".concat(e.name," has been removed from the mess.")}),i()}catch(e){b({title:"Error",description:e.message||"Failed to remove member.",variant:"destructive"})}finally{A(!1)}};return(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{className:"font-headline",children:"Member List"}),(0,a.jsx)(d.BT,{children:"Here are all the members currently in your mess."})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"Member"}),(0,a.jsx)(o.nd,{className:"text-right",children:"Balance"}),(0,a.jsx)(o.nd,{className:"text-center",children:"Total Meals"}),(0,a.jsx)(o.nd,{className:"text-right",children:(0,a.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,a.jsx)(o.BF,{children:s.map(e=>(0,a.jsxs)(o.Hj,{className:"hover:bg-muted/50",children:[(0,a.jsx)(o.nA,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(c.eu,{className:"h-10 w-10",children:[(0,a.jsx)(c.BK,{src:e.avatar,alt:e.name,"data-ai-hint":"person portrait"}),(0,a.jsx)(c.q5,{children:e.name.substring(0,2).toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:e.name}),"manager"===e.role&&(0,a.jsx)("span",{className:"text-xs text-primary ml-2 font-normal",children:"(Manager)"})]})]})}),(0,a.jsxs)(o.nA,{className:"text-right font-mono font-bold text-lg ".concat(e.balance>=0?"text-success":"text-destructive"),children:["à§³",e.balance.toFixed(2)]}),(0,a.jsx)(o.nA,{className:"text-center font-mono text-lg",children:e.meals.toFixed(1).replace(/\.0$/,"")}),(0,a.jsx)(o.nA,{className:"text-right",children:(0,a.jsxs)(f.rI,{children:[(0,a.jsx)(f.ty,{asChild:!0,children:(0,a.jsxs)(r.$,{"aria-haspopup":"true",size:"icon",variant:"ghost",children:[(0,a.jsx)(h,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"sr-only",children:["Toggle menu for ",e.name]})]})}),(0,a.jsxs)(f.SQ,{align:"end",children:[(0,a.jsx)(f.lp,{children:"Actions"}),(0,a.jsxs)(f._2,{onSelect:()=>m("ledger",e),children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"View Meal Ledger"]}),(0,a.jsxs)(f._2,{onSelect:()=>m("transactions",e),children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"View Transactions"]}),g&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.mB,{}),(0,a.jsxs)(f._2,{onSelect:()=>m("mealRecord",e),children:[(0,a.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Add/Edit Meal Record"]}),e.id!==l.uid&&(0,a.jsxs)(v.Lt,{children:[(0,a.jsx)(v.tv,{asChild:!0,children:(0,a.jsxs)(f._2,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:bg-destructive/10 focus:text-destructive",children:[(0,a.jsx)(j,{className:"mr-2 h-4 w-4"}),"Remove from Mess"]})}),(0,a.jsxs)(v.EO,{children:[(0,a.jsxs)(v.wd,{children:[(0,a.jsxs)(v.r7,{children:["Remove ",e.name,"?"]}),(0,a.jsxs)(v.$v,{children:["Are you sure you want to remove ",(0,a.jsx)("strong",{children:e.name})," from the mess? This action cannot be undone."]})]}),(0,a.jsxs)(v.ck,{children:[(0,a.jsx)(v.Zr,{children:"Cancel"}),(0,a.jsx)(v.Rx,{onClick:()=>k(e),disabled:w,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Confirm Removal"})]})]})]})]})]})]})})]},e.id))})]})})]})});var b=t(93004),w=t(56104),A=t(35695),k=t(54165),S=t(62523),C=t(85057),I=t(15599),M=t(7390);function R(e){let{isOpen:s,setIsOpen:t,messName:n,inviteCode:l}=e,{toast:i}=(0,N.dj)(),c=()=>{navigator.clipboard.writeText(l),i({title:"Copied!",description:"Invite code copied to clipboard."})},d=async()=>{let e={title:"Join ".concat(n," on Mess Ledger"),text:'Join our mess "'.concat(n,'" on Mess Ledger with this code: ').concat(l),url:window.location.origin};if(navigator.share)try{await navigator.share(e)}catch(e){console.error("Error sharing:",e),c(),i({title:"Sharing failed",description:"Invite code copied to clipboard instead.",variant:"destructive"})}else c(),i({title:"Share not supported",description:"Invite code copied to clipboard instead."})};return(0,a.jsx)(k.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(k.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsx)(k.L3,{className:"font-headline",children:"Invite New Members"}),(0,a.jsxs)(k.rr,{children:['Share this invite code with people you want to join your mess, "',n,'".']})]}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)(C.J,{htmlFor:"invite-code",className:"text-muted-foreground",children:"Invite Code"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(S.p,{id:"invite-code",value:l,readOnly:!0,className:"uppercase text-lg font-mono tracking-widest"}),(0,a.jsxs)(r.$,{type:"button",size:"icon",variant:"outline",onClick:c,children:[(0,a.jsx)(I.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Copy"})]}),(0,a.jsxs)(r.$,{type:"button",size:"icon",variant:"outline",onClick:d,children:[(0,a.jsx)(M.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Share"})]})]})]})]})})}var O=t(63894),q=t(17313),E=t(66424),_=t(75943),F=t(77223),z=t(83013),H=t(77128),L=t(65842);function V(e){let{isOpen:s,setIsOpen:t,member:i,messId:c,currentUserProfile:d,onSuccess:m}=e,[h,x]=(0,n.useState)([]),[u,p]=(0,n.useState)([]),[j,f]=(0,n.useState)(!0),[g,b]=(0,n.useState)(!1),[w,A]=(0,n.useState)(!1),[S,C]=(0,n.useState)(!1),[I,M]=(0,n.useState)(null),[R,O]=(0,n.useState)(null),[V,P]=(0,n.useState)(null),{toast:B}=(0,N.dj)(),U="manager"===d.role,Z=d.uid===i.id,T=(0,n.useCallback)(()=>{s&&i&&(f(!0),Promise.all([(0,y.Ce)(c,i.id),(0,y.Q8)(c,i.id)]).then(e=>{let[s,t]=e;x(s),p(t)}).catch(e=>{console.error("Failed to fetch transaction history:",e),B({title:"Error",description:"Could not load transaction history.",variant:"destructive"})}).finally(()=>f(!1)))},[s,c,i,B]);(0,n.useEffect)(()=>{T()},[T]);let D=e=>{M(e),A(!0)},$=e=>{O(e),C(!0)},G=e=>{P(e)},J=async()=>{if(V){b(!0);try{U?"deposit"===V.type?(await (0,y.Wc)(c,V.data),B({title:"Success",description:"Deposit has been deleted."})):"expense"===V.type&&(await (0,y.Wz)(c,V.data.id),B({title:"Success",description:"Expense has been deleted."})):Z&&("deposit"===V.type?(await (0,y.jA)(c,V.data),B({title:"Request Sent",description:"Your request to delete the deposit has been sent for approval."})):"expense"===V.type&&(await (0,y.b1)(c,V.data),B({title:"Request Sent",description:"Your request to delete the expense has been sent for approval."}))),m(),T()}catch(e){console.error("Failed to process delete request:",e),B({title:"Error",description:"Could not process the delete request.",variant:"destructive"})}finally{b(!1),P(null)}}},X=e=>{let{data:s,type:t}=e;return(0,a.jsx)(E.F,{className:"h-72",children:(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:["expense"===t&&(0,a.jsx)(o.nd,{children:"Description"}),(0,a.jsx)(o.nd,{children:"Date"}),(0,a.jsx)(o.nd,{className:"text-right",children:"Amount"}),(U||Z)&&(0,a.jsx)(o.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(o.BF,{children:s.length>0?s.map(e=>(0,a.jsxs)(o.Hj,{children:["expense"===t&&(0,a.jsx)(o.nA,{children:e.description}),(0,a.jsx)(o.nA,{children:(0,z.GP)(new Date(e.date),"PP")}),(0,a.jsxs)(o.nA,{className:"text-right font-mono ".concat("deposit"===t?"text-success":"text-destructive"),children:["deposit"===t?"+":"-"," à§³",e.amount.toFixed(2)]}),(U||Z)&&(0,a.jsxs)(o.nA,{className:"text-right",children:[(0,a.jsx)(r.$,{variant:"ghost",size:"icon",onClick:()=>"deposit"===t?D(e):$(e),children:(0,a.jsx)(_.A,{className:"h-4 w-4"})}),(0,a.jsx)(r.$,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>G({type:t,data:e}),children:(0,a.jsx)(F.A,{className:"h-4 w-4"})})]})]},e.id)):(0,a.jsx)(o.Hj,{children:(0,a.jsxs)(o.nA,{colSpan:U||Z?4:3,className:"h-24 text-center",children:["No ",t,"s found."]})})})]})})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(k.Cf,{className:"max-w-3xl",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsxs)(k.L3,{className:"font-headline",children:["Transaction History for ",i.name]}),(0,a.jsx)(k.rr,{children:U?"View and manage approved deposits and expenses for this member.":Z?"View your approved transactions. You can request changes to your own records.":"View approved transactions for this member."})]}),j?(0,a.jsx)("div",{className:"flex h-80 items-center justify-center",children:(0,a.jsx)(l.A,{className:"h-8 w-8 animate-spin"})}):(0,a.jsxs)(q.tU,{defaultValue:"deposits",className:"py-4",children:[(0,a.jsxs)(q.j7,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(q.Xi,{value:"deposits",children:["Deposits (",h.length,")"]}),(0,a.jsxs)(q.Xi,{value:"expenses",children:["Expenses (",u.length,")"]})]}),(0,a.jsx)(q.av,{value:"deposits",className:"mt-4",children:(0,a.jsx)(X,{data:h,type:"deposit"})}),(0,a.jsx)(q.av,{value:"expenses",className:"mt-4",children:(0,a.jsx)(X,{data:u,type:"expense"})})]})]})}),I&&(0,a.jsx)(H.b,{isOpen:w,setIsOpen:A,deposit:I,messId:c,onSuccess:()=>{T(),m()},isMemberRequest:!U&&Z}),R&&(0,a.jsx)(L.N,{isOpen:S,setIsOpen:C,expense:R,messId:c,onSuccess:()=>{T(),m()},isMemberRequest:!U&&Z}),(0,a.jsx)(v.Lt,{open:!!V,onOpenChange:e=>!e&&P(null),children:(0,a.jsxs)(v.EO,{children:[(0,a.jsxs)(v.wd,{children:[(0,a.jsx)(v.r7,{children:"Are you absolutely sure?"}),(0,a.jsx)(v.$v,{children:U?"This action cannot be undone. This will permanently delete the ".concat(null==V?void 0:V.type," of à§³").concat(null==V?void 0:V.data.amount.toFixed(2)," and adjust the member's balance."):"This will send a request to the manager to delete this ".concat(null==V?void 0:V.type,". You will be notified when it's approved or rejected.")})]}),(0,a.jsxs)(v.ck,{children:[(0,a.jsx)(v.Zr,{children:"Cancel"}),(0,a.jsxs)(v.Rx,{onClick:J,disabled:g,className:"bg-destructive hover:bg-destructive/90",children:[g?(0,a.jsx)(l.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,U?"Confirm Delete":"Send Request"]})]})]})})]})}var P=t(83343);function B(e){let{isOpen:s,setIsOpen:t,messId:r,memberId:i,memberName:c}=e,[d,m]=(0,n.useState)([]),[h,x]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{s&&r&&i&&(x(!0),(0,y.nE)(r,i,30).then(m).catch(console.error).finally(()=>x(!1)))},[s,r,i]),(0,a.jsx)(k.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(k.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsxs)(k.L3,{className:"font-headline",children:["Meal Ledger for ",c]}),(0,a.jsx)(k.rr,{children:"Showing meal history for the last 30 days."})]}),(0,a.jsx)("div",{className:"py-4",children:h?(0,a.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,a.jsx)(l.A,{className:"h-8 w-8 animate-spin"})}):(0,a.jsx)(E.F,{className:"h-96",children:(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{className:"sticky top-0 bg-card",children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"Date"}),(0,a.jsx)(o.nd,{className:"text-center",children:"Breakfast"}),(0,a.jsx)(o.nd,{className:"text-center",children:"Lunch"}),(0,a.jsx)(o.nd,{className:"text-center",children:"Dinner"})]})}),(0,a.jsx)(o.BF,{children:d.length>0?d.map(e=>(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nA,{className:"font-medium",children:(0,z.GP)((0,P.H)(e.date),"EEE, MMM d")}),(0,a.jsx)(o.nA,{className:"text-center font-mono",children:e.breakfast}),(0,a.jsx)(o.nA,{className:"text-center font-mono",children:e.lunch}),(0,a.jsx)(o.nA,{className:"text-center font-mono",children:e.dinner})]},e.date)):(0,a.jsx)(o.Hj,{children:(0,a.jsx)(o.nA,{colSpan:4,className:"text-center text-muted-foreground h-24",children:"No meal records found."})})})]})})})]})})}function U(){var e;let[s,t]=(0,n.useState)([]),[c,d]=(0,n.useState)(null),[o,m]=(0,n.useState)(null),[h,x]=(0,n.useState)(!0),u=(0,A.useRouter)(),[p,j]=(0,n.useState)(null),[f,v]=(0,n.useState)(!1),[N,k]=(0,n.useState)(!1),[S,C]=(0,n.useState)(!1),[I,M]=(0,n.useState)(!1),[q,E]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!w.j2)return void u.push("/login");let e=(0,b.hg)(w.j2,e=>{e?j(e):u.push("/login")});return()=>e()},[u]);let _=(0,n.useCallback)(()=>{p&&(x(!0),(0,y.VM)(p.uid).then(e=>{d(e),e&&e.messId?Promise.all([(0,y.pR)(e.messId),(0,y.ZJ)(e.messId)]).then(e=>{let[s,a]=e;t(s),m(a)}).catch(e=>{console.error("Failed to load members page data",e)}).finally(()=>{x(!1)}):u.push("/welcome")}))},[p,u]);(0,n.useEffect)(()=>{_()},[_]);let F=(0,n.useCallback)((e,s)=>{E(s),"mealRecord"===e&&k(!0),"transactions"===e&&C(!0),"ledger"===e&&M(!0)},[]);if(h||!c)return(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsx)(l.A,{className:"h-8 w-8 animate-spin"})});let z=(null==c?void 0:c.role)==="manager";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-end",children:z&&(0,a.jsxs)(r.$,{onClick:()=>v(!0),children:[(0,a.jsx)(i.A,{className:"mr-2 h-4 w-4"})," Invite New Member"]})}),(null==c?void 0:c.messId)&&(0,a.jsx)(g,{members:s,messId:c.messId,currentUserProfile:c,onUpdate:_,onAction:F})]}),o&&o.inviteCode&&(0,a.jsx)(R,{isOpen:f,setIsOpen:v,messName:o.name,inviteCode:o.inviteCode}),q&&(null==c?void 0:c.messId)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O.c,{isOpen:N,setIsOpen:k,messId:c.messId,memberId:q.id,memberName:q.name,onSuccess:_,mealSettings:null!=(e=null==o?void 0:o.mealSettings)?e:null}),(0,a.jsx)(V,{isOpen:S,setIsOpen:C,member:q,messId:c.messId,currentUserProfile:c,onSuccess:_}),(0,a.jsx)(B,{isOpen:I,setIsOpen:M,messId:c.messId,memberId:q.id,memberName:q.name})]})]})}},81379:(e,s,t)=>{Promise.resolve().then(t.bind(t,62801))},91394:(e,s,t)=>{"use strict";t.d(s,{BK:()=>c,eu:()=>i,q5:()=>d});var a=t(95155),n=t(12115),r=t(54011),l=t(59434);let i=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.bL,{ref:s,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...n})});i.displayName=r.bL.displayName;let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r._V,{ref:s,className:(0,l.cn)("aspect-square h-full w-full",t),...n})});c.displayName=r._V.displayName;let d=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(r.H4,{ref:s,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...n})});d.displayName=r.H4.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,1982,8502,7239,9032,7328,5876,5152,3013,7655,5576,4257,3024,1785,5951,4987,6612,8441,1684,7358],()=>s(81379)),_N_E=e.O()}]);